---
// Importación de componentes
import NewsCard from "./NewsCard.astro";
import ContentSection from "@components/ContentSection.astro";
---
<ContentSection color="gray">
  <div class="text-news">
    <div class="content-news">
      <h2>Actualidad</h2>
      <p class="content-text">
        Mantente al día con las últimas noticias y eventos de nuestro grupo de investigación.
      </p>
    </div>
  </div>
</ContentSection>

<ContentSection color="white">
  <div class="tabs">
    <div class="tabs-triggers-wrapper">
      <div class="tabs-triggers">
        <button class="tabs-trigger active" data-tab="noticias">Noticias</button>
        <button class="tabs-trigger" data-tab="agenda">Agenda de Eventos</button>
      </div>
    </div>

    <!-- Filtro de  búsqueda -->
    <div class="filter-container">
      <input type="text" placeholder="Buscar noticias..." class="search-input" id="search-input" />
      <select class="category-filter" id="category-filter">
        <option value="">Filtrar por categoría</option>
        <option value="proyecto">Proyecto</option>
        <option value="evento">Evento</option>
        <option value="infraestructura">Infraestructura</option>
      </select>
    </div>

    <div id="noticias" class="tab-content active">
      <section class="event-container" id="noticias-container">
        <NewsCard
          title="Nuevo proyecto de investigación aprobado"
          tag="Proyecto"
          date="15 Mar 2025"
          description="Nuestro grupo ha recibido financiación para un nuevo proyecto sobre energías renovables."
          img={{ src: "placeholder.svg", alt: "proyecto" }}
        />
        <NewsCard
          title="Participación en congreso internacional"
          tag="Evento"
          date="22 Ene 2025"
          description="Presentamos nuestros avances en el Congreso de Innovación Científica en Berlín."
          img={{ src: "placeholder.svg", alt: "evento" }}
        />
        <NewsCard
          title="Lanzamiento de laboratorio de prototipado"
          tag="Infraestructura"
          date="30 Mar 2025"
          description="Inauguramos un nuevo laboratorio dedicado al desarrollo de prototipos tecnológicos."
          img={{ src: "placeholder.svg", alt: "laboratorio" }}
        />
      </section>
    </div>

    <div id="agenda" class="tab-content">
      <section class="event-container" id="agenda-container">
        <NewsCard
          title="Seminario de Innovación Tecnológica"
          tag="Seminario"
          date="10 Abr 2025"
          description="Únete a nuestro seminario sobre las últimas tendencias en innovación."
          img={{ src: "placeholder.svg", alt: "seminario" }}
        />
        <NewsCard
          title="Taller de Energías Renovables"
          tag="Taller"
          date="20 Abr 2025"
          description="Aprende sobre energía solar y eólica en nuestro taller práctico."
          img={{ src: "placeholder.svg", alt: "taller" }}
        />
        <NewsCard
          title="Foro de Sostenibilidad 2025"
          tag="Foro"
          date="05 May 2025"
          description="Participa en nuestro foro sobre sostenibilidad y medio ambiente."
          img={{ src: "placeholder.svg", alt: "foro" }}
        />
      </section>
    </div>
  </div>
</ContentSection>

<ContentSection color="gray">
  <div class="subscription-container">
    <h2>Mantente informado</h2>
    <p class="subscription-text">
      Suscríbete a nuestro boletín para recibir las últimas noticias y eventos directamente en tu correo.
    </p>
    <div class="subscription-form">
      <input
        type="email"
        placeholder="Tu correo electrónico"
        class="subscription-input"
      />
      <button class="subscription-button">Suscribirse</button>
    </div>
  </div>
</ContentSection>

<style>
.text-news {
  text-align: center;
  margin-bottom: 2rem;
}

.content-news h2 {
  font-size: 2.5rem;
}

.content-text {
  font-size: 1rem;
  color: #555;
}

/* Contenedor de los botones */
.tabs-triggers-wrapper {
  background-color: #ccc;
  padding: 5px;
  border-radius: 5px;
  margin-bottom: 2rem;
}

.tabs {
  text-align: center;
}

.tabs-triggers {
  display: flex;
  justify-content: center;
  gap: 1.5rem;
}

.tabs-trigger {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 1rem;
  font-size: 1.2rem;
  font-weight: 400;
  border: 0.5px solid #ccc;
  background-color: white;
  color: black;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.2s, border-color 0.2s, color 0.2s;
  text-decoration: none;
  flex: 1;
}

/* Cambio de botones */
.tabs-trigger:hover {
  background-color: #f0f0f0;
  border-color: #999999;
}

.tabs-trigger.active {
  background-color: #f0f0f0;
  color: black;
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
}

.event-container {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  justify-content: center;
}

/* Estilo de los filtros */
.filter-container {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-top: 3rem; /* Espaciado superior */
  margin-bottom: 2rem; /* Espaciado inferior */
  width: 100%;
}

.search-input {
  padding: 0.5rem;
  font-size: 1rem;
  border-radius: 5px;
  border: 1px solid #ccc;
  width: 80%; /* 80% del ancho */
}

.category-filter {
  padding: 0.5rem;
  font-size: 1rem;
  border-radius: 5px;
  border: 1px solid #ccc;
  width: 20%; /* 20% del ancho */
}

.subscription-container {
  max-width: 1200px; 
  margin: 0 auto;
  padding: 2rem;
  background-color: white; /* Asegúrate que sea distinto del gris claro del section */
  border-radius: 0.5rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  text-align: center;
}

.subscription-container h2 {
  font-size: 1.75rem;
  margin-bottom: 0.5rem;
}

.subscription-text {
  color: #555;
  margin-bottom: 1.5rem;
}

.subscription-form {
  display: flex;
  gap: 1rem;
  justify-content: center;
  flex-wrap: wrap;
}

.subscription-input {
  flex: 1 1 300px;
  padding: 0.75rem 1rem;
  font-size: 1rem;
  border: 1px solid #ccc;
  border-radius: 0.375rem;
}

.subscription-button {
  padding: 0.75rem 1.5rem;
  font-size: 1rem;
  background-color: #000;
  color: #fff;
  border: none;
  border-radius: 0.375rem;
  cursor: pointer;
  transition: background-color 0.2s;
}

.subscription-button:hover {
  background-color: #333;
}

</style>

<script is:inline>
document.addEventListener('DOMContentLoaded', () => {
  const triggers = document.querySelectorAll('.tabs-trigger');
  const contents = document.querySelectorAll('.tab-content');

  triggers.forEach(trigger => {
    trigger.addEventListener('click', () => {
      const tabId = trigger.getAttribute('data-tab');

      // Quitar todas las clases active
      triggers.forEach(t => t.classList.remove('active'));
      contents.forEach(c => c.classList.remove('active'));

      // Activar la correcta
      trigger.classList.add('active');
      document.getElementById(tabId).classList.add('active');
    });
  });

  // Filtrado para noticias
  const searchInput = document.getElementById('search-input');
  const categoryFilter = document.getElementById('category-filter');
  const noticiasContainer = document.getElementById('noticias-container');

  searchInput.addEventListener('input', filterNews);
  categoryFilter.addEventListener('change', filterNews);

  function filterNews() {
    const searchTerm = searchInput.value.toLowerCase();
    const selectedCategory = categoryFilter.value;

    const newsCards = noticiasContainer.querySelectorAll('.news-card');

    newsCards.forEach(card => {
      const title = card.querySelector('.news-card-title').textContent.toLowerCase();
      const description = card.querySelector('.news-card-description').textContent.toLowerCase();
      const category = card.querySelector('.news-card-tag').textContent.toLowerCase();

      const matchesSearchTerm = title.includes(searchTerm) || description.includes(searchTerm);
      const matchesCategory = selectedCategory ? category.includes(selectedCategory.toLowerCase()) : true;

      if (matchesSearchTerm && matchesCategory) {
        card.style.display = '';
      } else {
        card.style.display = 'none';
      }
    });
  }

  // Filtrado para la agenda de eventos
  const searchInputAgenda = document.getElementById('search-input-agenda');
  const categoryFilterAgenda = document.getElementById('category-filter-agenda');
  const agendaContainer = document.getElementById('agenda-container');

  searchInputAgenda.addEventListener('input', filterAgenda);
  categoryFilterAgenda.addEventListener('change', filterAgenda);

  function filterAgenda() {
    const searchTerm = searchInputAgenda.value.toLowerCase();
    const selectedCategory = categoryFilterAgenda.value;

    const eventCards = agendaContainer.querySelectorAll('.news-card');

    eventCards.forEach(card => {
      const title = card.querySelector('.news-card-title').textContent.toLowerCase();
      const description = card.querySelector('.news-card-description').textContent.toLowerCase();
      const category = card.querySelector('.news-card-tag').textContent.toLowerCase();

      const matchesSearchTerm = title.includes(searchTerm) || description.includes(searchTerm);
      const matchesCategory = selectedCategory ? category.includes(selectedCategory.toLowerCase()) : true;

      if (matchesSearchTerm && matchesCategory) {
        card.style.display = '';
      } else {
        card.style.display = 'none';
      }
    });
  }
});
</script>
